/*
  iOS Safari fix:
  Some iPhone Safari versions intermittently rasterize fixed pseudo-element layers
  (especially with compositing/filter/opacity) as a solid color during refresh.

  We avoid the pseudo-element technique on iOS and instead apply the background
  directly to <body>, which is more stable.
*/

/* Cache-bust just in case iOS is holding onto a bad raster */
:root {
  --bg-pattern-url: url('/background-pattern.png?v=3');
}

@supports (-webkit-touch-callout: none) {
  body {
    background-color: hsl(60 20% 97%);
  }

  body::before {
    display: none !important;
  }

  body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
    background-image: var(--bg-pattern-url);
    background-size: cover;
    background-position: center center;
    background-repeat: no-repeat;
    z-index: -1;
    opacity: 0.5;
    /* Same dark green tint and 15% line opacity as desktop */
    filter: sepia(100%) saturate(400%) hue-rotate(90deg) brightness(0.4) opacity(0.15);
    pointer-events: none;
  }
}
